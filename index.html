<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Legal Statement Organizer</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
  body { font-family: Arial, sans-serif; }
  .output { background:#f0f0f0; padding:10px; margin-top:10px; }
  .output p { text-indent: 1.5em; margin: 0 0 10px 0; }
  .output strong { color: blue; }
</style>
</head>
<body>

<textarea id="text" rows="10" style="width:100%;">
SUMMARY OF EVENTS:
This is the first event.
It continues here.

KEY CONCERNS:
Concern one.
Concern two.

REQUEST / PURPOSE:
I request clarification.
</textarea>

<button onclick="showPreview()">Preview</button>
<button onclick="downloadPDF()">PDF</button>

<div id="preview" class="output"></div>

<script>
function showPreview() {
  const raw = document.getElementById("text").value;
  const sections = ["SUMMARY OF EVENTS:", "KEY CONCERNS:", "REQUEST / PURPOSE:"];
  const paragraphs = raw.split(/\n\n/);
  let html = "";
  paragraphs.forEach(p => {
    const lines = p.split("\n").map(l => l.trim()).filter(l=>l);
    lines.forEach((line,i)=>{
      if(sections.includes(line)){
        html += `<p><strong>${line}</strong></p>`;
      } else {
        html += `<p>${line}</p>`;
      }
    });
  });
  document.getElementById("preview").innerHTML = html;
  window.finalText = paragraphs;
}

function downloadPDF() {
  if(!window.finalText){ alert("Generate preview first"); return; }
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  let y = 20;
  const sections = ["SUMMARY OF EVENTS:", "KEY CONCERNS:", "REQUEST / PURPOSE:"];
  window.finalText.forEach(p=>{
    const lines = p.split("\n").map(l=>l.trim()).filter(l=>l);
    lines.forEach(line=>{
      const isHeading = sections.includes(line);
      doc.setFont(undefined, isHeading ? "bold" : "normal");
      const x = isHeading ? 20 : 30;
      doc.text(line, x, y);
      y += 10;
    });
    y += 5;
  });
  doc.save("statement.pdf");
}
</script>

</body>
</html>
